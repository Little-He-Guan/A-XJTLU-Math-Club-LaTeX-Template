\section{教程2: Delilah和复杂的数学公式}
Delilah 正在研究有关线性代数的材料的一部分。 随着工作的进行，她将获得处理 \LaTeX{} 中复杂数学公式的能力，尤其是 xjtlumath 中加载的 ams 包提供的那些方法。 

\subsection{多行公式}
线性方程组是线性代数的基本部分。 当 Delilah 尝试输入一组方程时，她遇到了一个问题。 在预定义的 \verb=\[\]= 和环境equation中，她找不到开始新行的选项。 甚至 \LaTeX{} 的换行选项，如 \verb=\\= 和 \verb=\newline= 在那里也不起作用。 一个方程组当然不应该放在一行，那她现在该怎么办？ 后来她了解到环境 \emph{aligned} 旨在允许方程组在多行中对齐：
\begin{miniexammar}{.4\textandmarginlen}{
\[
\begin{aligned}
x+y &= 1\\
x-y &= 2
\end{aligned}
\]
}
\begin{lstlisting}
\[
\begin{aligned}
x+y &= 1\\
x-y &= 2
\end{aligned}
\]
\end{lstlisting}
\end{miniexammar}

这里，与符号 \verb=&= 用在方程要对齐的符号之前。 换行符 \verb=\\= 开始一行新的等式。 请注意，此处不能使用其他换行操作。

Delilah 喜欢这个结果，但她觉得方程式太孤单了。 她认为为他们添加一个大花括号会安慰他们。 \LaTeX{} 支持将分隔符放在一组事物之前和之后的语法。
\begin{miniexammar}{.4\textandmarginlen}{
\[
\left\{
\begin{aligned}
x+y &= 1\\
x-y &= 2
\end{aligned}
\right.
\]
}
\begin{lstlisting}
\[
\left\{
\begin{aligned}
x+y &= 1\\
x-y &= 2
\end{aligned}
\right.
\]
\end{lstlisting}
\end{miniexammar}
\verb=\left= 命令定义要放在左边的东西，而\verb=\right= 命令定义要放在右边的东西。 Delilah 不想把任何东西放在右边，所以写了 \verb=.=表示空。

对于一组不需要对齐的方程，或者对于一个太长而不能放在一行中的单个方程，没有对齐的环境 \emph{gathered} 是更好的选择：
\begin{miniexammar}{.45\textandmarginlen}{
\[
\begin{gathered}
\cos {z} = 1 - \frac{z^2}{2!} + \frac{z^4}{4!} - \frac{z^6}{6!} + \cdots \\
= \sum_{n=0}^\infty {\frac{(-1)^n z^{2n}}{(2n!)}}
\end{gathered}
\]
}
\begin{lstlisting}
\[
\begin{gathered}
\cos {z} = 1 - \frac{z^2}{2!} + \frac{z^4}{4!} - \cdots \\
= \sum_{n=0}^\infty {\frac{(-1)^n z^{2n}}{(2n!)}}
\end{gathered}
\]
\end{lstlisting}
\end{miniexammar}

写了几组方程后，Delilah 想引用其中的一组。 她使用equation环境而不是 \verb=\[\]=，但发现方程是作为一个整体编号的。
\begin{miniexammar}{.4\textandmarginlen}{
\begin{equation}
\begin{aligned}
x+y &= 1\\
x-y &= 2
\end{aligned}
\end{equation}
}
\begin{lstlisting}
\begin{equation}
\begin{aligned}
x+y &= 1\\
x-y &= 2
\end{aligned}
\end{equation}
\end{lstlisting}
\end{miniexammar}
所以她很难在一个组中引用单个方程。 amsmath 为此提供环境 align：

\begin{miniexammar}{.4\textandmarginlen}{
\begin{align}
x+y &= 1\\
x-y &= 2
\end{align}
}
\begin{lstlisting}
\begin{align}
x+y &= 1\\
x-y &= 2
\end{align}
\end{lstlisting}
\end{miniexammar}

如果她不想为单个方程编号，则需要在该行的末尾附加 \verb=\nonumber=。
\begin{miniexammar}{.4\textandmarginlen}{
\begin{align}
x+y &= 1\\
z&=10 \nonumber\\
x-y &= 2
\end{align}
}
\begin{lstlisting}
\begin{align}
x+y &= 1\\
z &= 10 \nonumber\\
x-y &= 2
\end{align}
\end{lstlisting}
\end{miniexammar}

如果没有 'ed' 后缀，\emph{gather} 也是一个独立的环境，可以完成gather的工作。 但是普通版本和“ed”版本之间有一个主要区别。 Delilah 发现不可能在对齐或聚集之前再次放置括号，因为它们不需要但被数学环境包围。 此外，它们的宽度固定为文本的宽度，而它们的“ed”版本可以是任何宽度。如果没有 'ed' 后缀，\emph{gather} 也是一个独立的环境，可以完成聚集的工作。 但是普通版本和“ed”版本之间有一个主要区别。 Delilah 发现不可能在对齐或聚集之前再次放置括号，因为它们不需要但被数学环境包围。 此外，它们的宽度固定为文本的宽度，而它们的“ed”版本可以是任何宽度。

与 equation 环境一样，它们的星号版本默认不给出数字。
\begin{miniexammar}{.4\textandmarginlen}{
\begin{align*}
x+y &= 1\\
x-y &= 2
\end{align*}
}
\begin{lstlisting}
\begin{align*}
x+y &= 1\\
x-y &= 2
\end{align*}
\end{lstlisting}
\end{miniexammar}

Delilah 能够将多组方程放在一个列中，只需在组之间添加\verb=&=号即可。
\begin{miniexammar}{.4\textandmarginlen}{
\begin{align*}
x+y &= 1  & a+b &= 3\\
x-y &= 2  & a-b &= 4
\end{align*}
}
\begin{lstlisting}
\begin{align*}
x+y &= 1  & a+b &= 3\\
x-y &= 2  & a-b &= 4
\end{align*}
\end{lstlisting}
\end{miniexammar}
align 自动调整方程组之间的空间。

\subsection{矩阵}
矩阵对于线性代数至关重要，因为它们表示从一个向量空间到另一个特定基底的线性映射。 此外，系数矩阵和增广矩阵便于操作线性方程。

amsmath 提供了多种输入矩阵的环境。
\begin{miniexammar}{.5\textandmarginlen}{
\[
\begin{bmatrix}
1&2&3&4\\
5&6&7&8\\
9&10&11&12\\
13&14&15&16
\end{bmatrix}
\]
}
\begin{lstlisting}
\[
\begin{bmatrix}
1&2&3&4\\
5&6&7&8\\
9&10&11&12\\
13&14&15&16
\end{bmatrix}
\]
\end{lstlisting}
\end{miniexammar}
环境 pmatrix、Bmatrix、vmatrix 和 Vmatrix 分别产生分隔符 \verb=()=、\verb={}=、\verb=||= 和 \verb=|| ||=。

为了在inline模式下使用矩阵，Delilah 使用环境 smallmatrix，它在 amsmath 中没有 p,b,B,v,V 版本，因为决定分隔符是作者的责任。
\begin{miniexammar}{.4\textandmarginlen}{
The matrix $\left(\begin{smallmatrix} a&b\\c&d \end{smallmatrix}\right)$ is so small and cute!
}
\begin{lstlisting}
The matrix $\left(\begin{smallmatrix} a&b\\c&d \end{smallmatrix}\right)$ is so small and cute!
\end{lstlisting}
\end{miniexammar}

当 Delilah 尝试将分数放入矩阵中时，她发现有些烦人事
。\begin{miniexammar}{.3\textandmarginlen}{
\[
\begin{bmatrix}
1&\frac{1}{2}&\frac{1}{3}\\
1&\frac{1}{4}&\frac{1}{5}\\
\end{bmatrix}
\]
}
\begin{lstlisting}
\[
\begin{bmatrix}
1&\frac{1}{2}&\frac{1}{3}\\
1&\frac{1}{4}&\frac{1}{5}\\
\end{bmatrix}
\]
\end{lstlisting}
\end{miniexammar}
上面和下面的分数非常接近，以至于它们相互接触！ 这不是 Delilah 想要的，她很惊讶 \LaTeX{} 没有检测到这一点并做一些事情。 幸运的是，在 amsmath 环境中，允许将可选参数传递给 \verb=\\= 以定义行之间的实际垂直空间。 对于分数，2ex 是一个不错的选择。 此外，分数处于inline模式。 \verb=\dfrac= 命令给出displayed模式的分数。
\begin{miniexammar}{.3\textandmarginlen}{
\[
\begin{bmatrix}
1&\dfrac{1}{2}&\dfrac{1}{3}\\[2ex]
1&\dfrac{1}{4}&\dfrac{1}{5}
\end{bmatrix}
\]
}
\begin{lstlisting}
\[
\begin{bmatrix}
1&\dfrac{1}{2}&\dfrac{1}{3}\\[2ex]
1&\dfrac{1}{4}&\dfrac{1}{5}
\end{bmatrix}
\]
\end{lstlisting}
\end{miniexammar}

有时矩阵太大而无法完全显示。 在这些时候，使用省略号很重要。 当 Delilah 写出矩阵的逆时，她使用省略号。
\begin{miniexammar}{.5\textandmarginlen}{
\[
A^{-1} = \frac{1}{\det A}
\begin{bmatrix}
C_{11} & C_{21} & \cdots & C_{n1} \\
C_{12} & C_{22} & \cdots & C_{n2} \\
\vdots & \vdots & \ddots & \vdots \\
C_{n2} & C_{n2} & \cdots & C_{nn} \\
\end{bmatrix}
\]
}
\begin{lstlisting}
\[
A^{-1} = \frac{1}{\det A}
\begin{bmatrix}
C_{11} & C_{21} & \cdots & C_{n1} \\
C_{12} & C_{22} & \cdots & C_{n2} \\
\vdots & C\vdots & \ddots & \vdots \\
C_{n2} & C_{n2} & \cdots & C_{nn} \\
\end{bmatrix}
\]
\end{lstlisting}
\end{miniexammar}

\subsection{文字和运算符}
要将文本放入数学环境中，Delilah 使用 amsmath 提供的 \verb=\text= 命令。
\begin{miniexammar}{.57\textandmarginlen}{
\begin{definition}[Null Space]
The null space of an $m \times n$ matrix $A$, written as $\Nul A$, is the set of all solutions
of the homogeneous equation $A\vec{x} = \vec{0}$. In set notation,
\[
\Nul A = \{\vec{x}:\vec{x} \text{ is in } \mathbb{R}^n \text{ and } A\vec{x} = \vec{0} \}
\]
\end{definition}
}
\begin{lstlisting}
\begin{definition}[Null Space]
The null space of an $m \times n$ matrix $A$, written as $\Nul A$, is the set of all solutions
of the homogeneous equation $A\vec{x} = \vec{0}$. In set notation,
\[
\Nul A = \{\vec{x}:\vec{x} \text{ is in } \mathbb{R}^n \text{ and } A\vec{x} = \vec{0} \}
\]
\end{definition}
\end{lstlisting}
\end{miniexammar}

\verb=\Nul=, \verb=\sin=, ... 等命令是数学运算符。 \LaTeX{} 中的部分预定义数学运算符显示在表 \ref{tab:predefmathop} 中。
\begin{table}[hbpt]·
\begin{center}
\small
\begin{tabular}{cl|cl|cl}
Result & Command & Result & Command & Result & Command \\
\hline
arccos & \verb=\arccos= & arcsin & \verb=\arcsin= & arctan & \verb=\arctan= \\
cos & \verb=\cos= & sin & \verb=\sin= & tan & \verb=\tan= \\
cot & \verb=\cot= & sec & \verb=\sec= & csc & \verb=\csc= \\
cosh & \verb=\cosh= & sinh & \verb=\sinh= & tanh & \verb=\tanh= \\
lim & \verb=\lim= & lim inf & \verb=\liminf= & lim sup & \verb=\limsup= \\
ln & \verb=\ln= & log & \verb=\log= & lg & \verb=\lg= \\
max & \verb=\max= & min & \verb=\min= & sup & \verb=\sup= \\
inf & \verb=\inf= &  &  &  &  \\
ker & \verb=\ker= & det & \verb=\det= & exp & \verb=\exp= 
\end{tabular}
\end{center}
\caption{一些预定义的数学运算符}
\label{tab:predefmathop}
\end{table}

实际上，运算符\verb=\Nul= 和\verb=\Span= 是由xjtlumath 定义的，如西浦一年级线性代数教科书中的形式。 此外，xjtlumath 更改了 \LaTeX{} 中的默认 \verb=\vec= 命令，以便矢量以粗体形式出现，而不是在其上方带有箭头。

一些运算符，如 \verb=\lim=，旨在支持对它取极限。 也就是说，在displayed模式下，当试图使用 \verb=_= 给这样的运算符一下标时，下标将出现在运算符的底部。
\begin{parexammar}{.4\textandmarginlen}{
\[
\lim_{x\to 0} f(x)
\]
}
\begin{lstlisting}
\[
\lim_{x\to 0} f(x)
\]
\end{lstlisting}
\end{parexammar}

Delilah 能够通过使用 \verb=\limits= 和 \verb=\nolimits= 来明确控制极限样式。 请注意，这两个命令只能在支持采取极限的操作后使用。
\begin{parexammar}{.4\textandmarginlen}{
$\lim\limits_{x \to 0}f(x)$
\[
\lim\nolimits_{x\to 0} f(x)
\]
}
\begin{lstlisting}
$\lim\limits_{x \to 0}f(x)$
\[
\lim\nolimits_{x\to 0} f(x)
\]
\end{lstlisting}
\end{parexammar}

\subsection{限制符}
Delilah 已经知道如何键入基本的分隔符。 对于圆括号和方括号，纯文本就行； 由于大括号是由 \LaTeX{} 保留的，因此 Delilah 需要在每个大括号之前添加一个反斜杠。
\begin{parexammar}{.45\textandmarginlen}{
The range of a function may be expressed explicitly by its domain and itself: the range of $f: X \to Y$ is $f(X)$.

In some context the arguments of a function are enclosed by square brackets: $f[x]$.

Curly brackets are often used to show a set: $S := \{2,4,\cdots\}$.
}
\begin{lstlisting}
The range of a function may be expressed explicitly by its domain and itself: the range of $f: X \to Y$ is $f(X)$.

In some context the arguments of a function are enclosed by square brackets: $f[x]$.

Curly brackets are often used to show a set: $S := \{2,4,\cdots\}$.
\end{lstlisting}
\end{parexammar}

然而，在某些情况下，被包围的表达式具有不同的高度，这时结果变得不令人满意。 \LaTeX{} 提供了一种机制，使用户能够自动或手动调整分隔符的大小。

在一对分隔符周围添加 \verb=\left= 和 \verb=\right= 会自动调整它们的大小以匹配所包含的表达式。 但是，有时我们希望分隔符更大或更小，这就是我们需要手动调整大小的时候。
\begin{parexammar}{.5\textandmarginlen}{
\[
\left( \frac{1}{2} \right) 
\Bigg( \bigg( \Big( \big( x\big) \Big) \bigg) \Bigg)
\]
}
\begin{lstlisting}
\[
\left(\frac{1}{2}\right) \Bigg( \bigg( \Big( \big( x\big) \Big) \bigg) \Bigg)
\]
\end{lstlisting}
\end{parexammar}

Delilah 曾经错配过一对分隔符，但她发现这两个符号的高度还是一样的。 此外，她还了解到点“.” 可用于通知 \LaTeX{} 不插入任何内容。
\begin{parexammar}{.5\textandmarginlen}{
A fraction enclosed left by a parenthesis, and right by a curly bracket.
\[
\left(\frac{a}{b}\right\}
\]
A system of equations
\[
\left\{
\begin{aligned}
x+y&=1\\
x-y&=2
\end{aligned}
\right.
\]
}
\begin{lstlisting}
A fraction enclosed left by a parenthesis, and right by a curly bracket.
\[
\left(\frac{a}{b}\right\}
\]
A system of equations
\[
\left\{
\begin{aligned}
x+y&=1\\
x-y&=2
\end{aligned}
\right.
\]
\end{lstlisting}
\end{parexammar}

现在 Delilah 知道如何正确处理分隔符，但是重复的 \verb=\left= 和 \verb=\right= 确实让她感到恶心。 xjtlumath 通过提供这些预定义的分隔符组来简化工作。以下的例子展示了这些预定义的分隔符组，和对分隔符大小的控制。
\begin{parexammar}{.5\textandmarginlen}{
These delimiters are defined by xjtlumath.
\[
\rbra{x},\ \sbra{x},\ \cbra{x},\ \abs{x},\ \floor{x},\ \ceiling{x}
\]
One can also change the delimiter resizer.
\[
\abs[\bigg]{x}
\]
}
\begin{lstlisting}
These delimiters are defined by xjtlumath.
\[
\rbra{x},\ \sbra{x},\ \cbra{x},\ \abs{x},\ \floor{x},\ \ceiling{x}
\]
One can also change the delimiter resizer.
\[
\abs[\bigg]{x}
\]
\end{lstlisting}
\end{parexammar}

\subsection{符号}
数学环境中的标准 \LaTeX{} 字体整洁干净。 然而在一些特殊场合，Delilah 想改变一些符号的字体。 例如，为了表示一些常规集合，她使用黑板字体。
\begin{parexammar}{.4\textandmarginlen}{
\[
\mathbb{R}\quad \mathbb{N}\quad \mathbb{Q}\quad \mathbb{Z}
\]
}
\begin{lstlisting}
\[
\mathbb{R}\quad \mathbb{N}\quad \mathbb{Q}\quad \mathbb{Z}
\]
\end{lstlisting}
\end{parexammar}

每次都写 \verb=\mathbb= 有点烦人。 为此，xjtlumath 为它们定义了简写。
\begin{parexammar}{.45\textandmarginlen}{
\[
\setr \quad \setq \quad \setz \quad \setn \quad \setnp
\]
}
\begin{lstlisting}
\[
\setr \quad \setq \quad \setz \quad \setn \quad \setnp
\]
\end{lstlisting}
\end{parexammar}

其他字体控制方法如我们在 \ref{subsec:fonts} 小节中讨论过的。 例如，\verb=\mathrm= 给出\textrm{Roman} 家族的字体，而\verb=\mathbf= 给出\textbf{bold} 系列的字体。
\begin{parexammar}{.45\textandmarginlen}{
\[
\mathrm{Like normal text} \quad \mathbf{bold}
\]
}
\begin{lstlisting}
\[
\mathrm{Like normal text} \quad \mathbf{bold}
\]
\end{lstlisting}
\end{parexammar}